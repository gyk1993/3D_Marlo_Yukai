function [violation, qmin, qmax, dqmin, dqmax, qminv, qmaxv, T] = MARLOBasicSafetyLimits2(q, dq) %#codegen
	% MARLOBASICSAFETYLIMITS2 Checks to see if the configuration and velocity satisfy basic safety limits.

	T = [...
		... % q1
		0 0 0 1 0 0 0 0 0 0 0 0 0;
		0 0 0 0 0 1 0 0 0 0 0 0 0; 
		... % q2
		0 0 0 0 1 0 0 0 0 0 0 0 0;
		0 0 0 0 0 0 1 0 0 0 0 0 0; 
		... % qLA
		0 0 0 0.5 0.5 0 0 0 0 0 0 0 0;
		0 0 0 0 0 0.5 0.5 0 0 0 0 0 0; 
		... % qKA
		0 0 0 -1 1 0 0 0 0 0 0 0 0;
		0 0 0 0 0 -1 1 0 0 0 0 0 0; 
		... % qgr1
		0 0 0 0 0 0 0 1 0 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 1 0 0; 
		... % qgr2
		0 0 0 0 0 0 0 0 1 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0 1 0; 
		... % qgrLA
		0 0 0 0 0 0 0 0.5 0.5 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0.5 0.5 0; 
		... % qgrKA
		0 0 0 0 0 0 0 -1 1 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 -1 1 0; 
		... % qsp1
		0 0 0 -1 0 0 0 1 0 0 0 0 0;
		0 0 0 0 0 -1 0 0 0 0 1 0 0; 
		... % qsp2
		0 0 0 0 -1 0 0 0 1 0 0 0 0;
		0 0 0 0 0 0 -1 0 0 0 0 1 0; 
		... % qspLA
		0 0 0 -0.5 -0.5 0 0 0.5 0.5 0 0 0 0;
		0 0 0 0 0 -0.5 -0.5 0 0 0 0.5 0.5 0; 
		... % qspKA
		0 0 0 1 -1 0 0 -1 1 0 0 0 0;
		0 0 0 0 0 1 -1 0 0 0 -1 1 0; 
		... % q3
		0 0 0 0 0 0 0 0 0 1 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0 0 1; 
		... % qDLA
		0 0 0 0.5 0.5 -0.5 -0.5 0 0 0 0 0 0; 
		... % q3RL
		0 0 0 0 0 0 0 0 0 1 0 0 1; 
		... % qxT
		0 0 1 0 0 0 0 0 0 0 0 0 0; 
		... % qyT
		0 1 0 0 0 0 0 0 0 0 0 0 0; 
		... % theta
		0 0 1 0.5 0.5 0 0 0 0 0 0 0 0;
		0 0 1 0 0 0.5 0.5 0 0 0 0 0 0; 
		... % thetagr
		0 0 1 0 0 0 0 0.5 0.5 0 0 0 0;
		0 0 1 0 0 0 0 0 0 0 0.5 0.5 0; 
	];

	qmin = [... % minimum q
		... % q1
		100.000000; 
		100.000000; 
		... % q2
		160.000000; 
		160.000000; 
		... % qLA
		130.000000; 
		130.000000; 
		... % qKA
		15.000000; 
		15.000000; 
		... % qgr1
		100.000000; 
		100.000000; 
		... % qgr2
		160.000000; 
		160.000000; 
		... % qgrLA
		130.000000; 
		130.000000; 
		... % qgrKA
		15.000000; 
		15.000000; 
		... % qsp1
		-2.000000; 
		-2.000000; 
		... % qsp2
		-6.000000; 
		-6.000000; 
		... % qspLA
		-3.000000; 
		-3.000000; 
		... % qspKA
		-8.000000; 
		-8.000000; 
		... % q3
		-20.000000; 
		-20.000000; 
		... % qDLA
		-45.000000; 
		... % q3RL
		-25.000000; 
		... % qxT
		-30.000000; 
		... % qyT
		-20.000000; 
		... % theta
		140.000000; 
		140.000000; 
		... % thetagr
		140.000000; 
		140.000000; 
	];
	qmax = [... % maximum q
		... % q1
		200.000000; 
		200.000000; 
		... % q2
		260.000000; 
		260.000000; 
		... % qLA
		230.000000; 
		230.000000; 
		... % qKA
		90.000000; 
		90.000000; 
		... % qgr1
		200.000000; 
		200.000000; 
		... % qgr2
		260.000000; 
		260.000000; 
		... % qgrLA
		230.000000; 
		230.000000; 
		... % qgrKA
		90.000000; 
		90.000000; 
		... % qsp1
		6.000000; 
		6.000000; 
		... % qsp2
		3.000000; 
		3.000000; 
		... % qspLA
		3.000000; 
		3.000000; 
		... % qspKA
		3.000000; 
		3.000000; 
		... % q3
		15.000000; 
		15.000000; 
		... % qDLA
		45.000000; 
		... % q3RL
		30.000000; 
		... % qxT
		15.000000; 
		... % qyT
		20.000000; 
		... % theta
		220.000000; 
		220.000000; 
		... % thetagr
		220.000000; 
		220.000000; 
	];
	dqmin = [... % minimum dq
		... % q1
		-400.000000; 
		-400.000000; 
		... % q2
		-400.000000; 
		-400.000000; 
		... % qLA
		-400.000000; 
		-400.000000; 
		... % qKA
		-500.000000; 
		-500.000000; 
		... % qgr1
		-400.000000; 
		-400.000000; 
		... % qgr2
		-400.000000; 
		-400.000000; 
		... % qgrLA
		-400.000000; 
		-400.000000; 
		... % qgrKA
		-500.000000; 
		-500.000000; 
		... % qsp1
		-200.000000; 
		-200.000000; 
		... % qsp2
		-400.000000; 
		-400.000000; 
		... % qspLA
		-300.000000; 
		-300.000000; 
		... % qspKA
		-600.000000; 
		-600.000000; 
		... % q3
		-250.000000; 
		-250.000000; 
		... % qDLA
		-400.000000; 
		... % q3RL
		-300.000000; 
		... % qxT
		-150.000000; 
		... % qyT
		-150.000000; 
		... % theta
		-300.000000; 
		-300.000000; 
		... % thetagr
		-300.000000; 
		-300.000000; 
	];
	dqmax = [... % maximum dq
		... % q1
		600.000000; 
		600.000000; 
		... % q2
		500.000000; 
		500.000000; 
		... % qLA
		500.000000; 
		500.000000; 
		... % qKA
		500.000000; 
		500.000000; 
		... % qgr1
		600.000000; 
		600.000000; 
		... % qgr2
		500.000000; 
		500.000000; 
		... % qgrLA
		500.000000; 
		500.000000; 
		... % qgrKA
		500.000000; 
		500.000000; 
		... % qsp1
		300.000000; 
		300.000000; 
		... % qsp2
		200.000000; 
		200.000000; 
		... % qspLA
		300.000000; 
		300.000000; 
		... % qspKA
		500.000000; 
		500.000000; 
		... % q3
		250.000000; 
		250.000000; 
		... % qDLA
		400.000000; 
		... % q3RL
		300.000000; 
		... % qxT
		150.000000; 
		... % qyT
		150.000000; 
		... % theta
		300.000000; 
		300.000000; 
		... % thetagr
		300.000000; 
		300.000000; 
	];
	qminv = [... % minimum q at full negative velocity (dqmin)
		... % q1
		160.000000; 
		160.000000; 
		... % q2
		200.000000; 
		200.000000; 
		... % qLA
		180.000000; 
		180.000000; 
		... % qKA
		30.000000; 
		30.000000; 
		... % qgr1
		160.000000; 
		160.000000; 
		... % qgr2
		200.000000; 
		200.000000; 
		... % qgrLA
		180.000000; 
		180.000000; 
		... % qgrKA
		30.000000; 
		30.000000; 
		... % qsp1
		-1.000000; 
		-1.000000; 
		... % qsp2
		-2.000000; 
		-2.000000; 
		... % qspLA
		-1.000000; 
		-1.000000; 
		... % qspKA
		-2.000000; 
		-2.000000; 
		... % q3
		-20.000000; 
		-20.000000; 
		... % qDLA
		-25.000000; 
		... % q3RL
		-25.000000; 
		... % qxT
		-20.000000; 
		... % qyT
		-10.000000; 
		... % theta
		160.000000; 
		160.000000; 
		... % thetagr
		160.000000; 
		160.000000; 
	];
	qmaxv = [... % maximum q at full positive velocity (dqmax)
		... % q1
		180.000000; 
		180.000000; 
		... % q2
		220.000000; 
		220.000000; 
		... % qLA
		180.000000; 
		180.000000; 
		... % qKA
		60.000000; 
		60.000000; 
		... % qgr1
		180.000000; 
		180.000000; 
		... % qgr2
		220.000000; 
		220.000000; 
		... % qgrLA
		180.000000; 
		180.000000; 
		... % qgrKA
		60.000000; 
		60.000000; 
		... % qsp1
		3.000000; 
		3.000000; 
		... % qsp2
		1.000000; 
		1.000000; 
		... % qspLA
		1.000000; 
		1.000000; 
		... % qspKA
		1.000000; 
		1.000000; 
		... % q3
		15.000000; 
		15.000000; 
		... % qDLA
		25.000000; 
		... % q3RL
		30.000000; 
		... % qxT
		0.000000; 
		... % qyT
		10.000000; 
		... % theta
		200.000000; 
		200.000000; 
		... % thetagr
		200.000000; 
		200.000000; 
	];

	% Check limits
	qbar = T * q * 180/pi;
	dqbar = T * dq * 180/pi;
	violation = (qbar < qmin) | (qbar > qmax) ...
		 | (dqbar < dqmin) | (dqbar > dqmax) ...
		 | dqbar .* (qminv - qmin) < dqmin .* (qbar - qmin) ...
		 | dqbar .* (qmax - qmaxv) > dqmax .* (qmax - qbar);
end
