function [violation, qmin, qmax, dqmin, dqmax, qminv, qmaxv, T] = MARLOBasicSafetyLimits4(q, dq) %#codegen
	% MARLOBASICSAFETYLIMITS4 Checks to see if the configuration and velocity satisfy basic safety limits.

	T = [...
		... % q1
		0 0 0 1 0 0 0 0 0 0 0 0 0;
		0 0 0 0 0 1 0 0 0 0 0 0 0; 
		... % q2
		0 0 0 0 1 0 0 0 0 0 0 0 0;
		0 0 0 0 0 0 1 0 0 0 0 0 0; 
		... % qLA
		0 0 0 0.5 0.5 0 0 0 0 0 0 0 0;
		0 0 0 0 0 0.5 0.5 0 0 0 0 0 0; 
		... % qKA
		0 0 0 -1 1 0 0 0 0 0 0 0 0;
		0 0 0 0 0 -1 1 0 0 0 0 0 0; 
		... % qgr1
		0 0 0 0 0 0 0 1 0 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 1 0 0; 
		... % qgr2
		0 0 0 0 0 0 0 0 1 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0 1 0; 
		... % qgrLA
		0 0 0 0 0 0 0 0.5 0.5 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0.5 0.5 0; 
		... % qgrKA
		0 0 0 0 0 0 0 -1 1 0 0 0 0;
		0 0 0 0 0 0 0 0 0 0 -1 1 0; 
		... % qsp1
		0 0 0 -1 0 0 0 1 0 0 0 0 0;
		0 0 0 0 0 -1 0 0 0 0 1 0 0; 
		... % qsp2
		0 0 0 0 -1 0 0 0 1 0 0 0 0;
		0 0 0 0 0 0 -1 0 0 0 0 1 0; 
		... % qspLA
		0 0 0 -0.5 -0.5 0 0 0.5 0.5 0 0 0 0;
		0 0 0 0 0 -0.5 -0.5 0 0 0 0.5 0.5 0; 
		... % qspKA
		0 0 0 1 -1 0 0 -1 1 0 0 0 0;
		0 0 0 0 0 1 -1 0 0 0 -1 1 0; 
		... % q3
		0 0 0 0 0 0 0 0 0 1 0 0 0;
		0 0 0 0 0 0 0 0 0 0 0 0 1; 
		... % qDLA
		0 0 0 0.5 0.5 -0.5 -0.5 0 0 0 0 0 0; 
		... % q3RL
		0 0 0 0 0 0 0 0 0 1 0 0 1; 
		... % qxT
		0 0 1 0 0 0 0 0 0 0 0 0 0; 
		... % qyT
		0 1 0 0 0 0 0 0 0 0 0 0 0; 
		... % theta
		0 0 1 0.5 0.5 0 0 0 0 0 0 0 0;
		0 0 1 0 0 0.5 0.5 0 0 0 0 0 0; 
		... % thetagr
		0 0 1 0 0 0 0 0.5 0.5 0 0 0 0;
		0 0 1 0 0 0 0 0 0 0 0.5 0.5 0; 
	];

	qmin = [... % minimum q
		... % q1
		100.000000; 
		100.000000; 
		... % q2
		140.000000; 
		140.000000; 
		... % qLA
		130.000000; 
		130.000000; 
		... % qKA
		25.000000; 
		25.000000; 
		... % qgr1
		100.000000; 
		100.000000; 
		... % qgr2
		140.000000; 
		140.000000; 
		... % qgrLA
		130.000000; 
		130.000000; 
		... % qgrKA
		25.000000; 
		25.000000; 
		... % qsp1
		-4.000000; 
		-4.000000; 
		... % qsp2
		-10.000000; 
		-10.000000; 
		... % qspLA
		-8.000000; 
		-8.000000; 
		... % qspKA
		-20.000000; 
		-20.000000; 
		... % q3
		-20.000000; 
		-20.000000; 
		... % qDLA
		-70.000000; 
		... % q3RL
		-40.000000; 
		... % qxT
		-25.000000; 
		... % qyT
		-20.000000; 
		... % theta
		120.000000; 
		120.000000; 
		... % thetagr
		120.000000; 
		120.000000; 
	];
	qmax = [... % maximum q
		... % q1
		240.000000; 
		240.000000; 
		... % q2
		250.000000; 
		250.000000; 
		... % qLA
		230.000000; 
		230.000000; 
		... % qKA
		180.000000; 
		180.000000; 
		... % qgr1
		240.000000; 
		240.000000; 
		... % qgr2
		250.000000; 
		250.000000; 
		... % qgrLA
		230.000000; 
		230.000000; 
		... % qgrKA
		180.000000; 
		180.000000; 
		... % qsp1
		10.000000; 
		10.000000; 
		... % qsp2
		5.000000; 
		5.000000; 
		... % qspLA
		5.000000; 
		5.000000; 
		... % qspKA
		8.000000; 
		8.000000; 
		... % q3
		15.000000; 
		15.000000; 
		... % qDLA
		70.000000; 
		... % q3RL
		25.000000; 
		... % qxT
		25.000000; 
		... % qyT
		20.000000; 
		... % theta
		240.000000; 
		240.000000; 
		... % thetagr
		240.000000; 
		240.000000; 
	];
	dqmin = [... % minimum dq
		... % q1
		-600.000000; 
		-600.000000; 
		... % q2
		-600.000000; 
		-600.000000; 
		... % qLA
		-600.000000; 
		-600.000000; 
		... % qKA
		-800.000000; 
		-800.000000; 
		... % qgr1
		-600.000000; 
		-600.000000; 
		... % qgr2
		-600.000000; 
		-600.000000; 
		... % qgrLA
		-600.000000; 
		-600.000000; 
		... % qgrKA
		-800.000000; 
		-800.000000; 
		... % qsp1
		-600.000000; 
		-600.000000; 
		... % qsp2
		-600.000000; 
		-600.000000; 
		... % qspLA
		-1000.000000; 
		-1000.000000; 
		... % qspKA
		-1000.000000; 
		-1000.000000; 
		... % q3
		-400.000000; 
		-400.000000; 
		... % qDLA
		-600.000000; 
		... % q3RL
		-600.000000; 
		... % qxT
		-250.000000; 
		... % qyT
		-250.000000; 
		... % theta
		-600.000000; 
		-600.000000; 
		... % thetagr
		-600.000000; 
		-600.000000; 
	];
	dqmax = [... % maximum dq
		... % q1
		600.000000; 
		600.000000; 
		... % q2
		600.000000; 
		600.000000; 
		... % qLA
		600.000000; 
		600.000000; 
		... % qKA
		800.000000; 
		800.000000; 
		... % qgr1
		600.000000; 
		600.000000; 
		... % qgr2
		600.000000; 
		600.000000; 
		... % qgrLA
		600.000000; 
		600.000000; 
		... % qgrKA
		800.000000; 
		800.000000; 
		... % qsp1
		600.000000; 
		600.000000; 
		... % qsp2
		600.000000; 
		600.000000; 
		... % qspLA
		1000.000000; 
		1000.000000; 
		... % qspKA
		1000.000000; 
		1000.000000; 
		... % q3
		400.000000; 
		400.000000; 
		... % qDLA
		600.000000; 
		... % q3RL
		600.000000; 
		... % qxT
		250.000000; 
		... % qyT
		250.000000; 
		... % theta
		600.000000; 
		600.000000; 
		... % thetagr
		600.000000; 
		600.000000; 
	];
	qminv = [... % minimum q at full negative velocity (dqmin)
		... % q1
		140.000000; 
		140.000000; 
		... % q2
		180.000000; 
		180.000000; 
		... % qLA
		150.000000; 
		150.000000; 
		... % qKA
		25.000000; 
		25.000000; 
		... % qgr1
		140.000000; 
		140.000000; 
		... % qgr2
		180.000000; 
		180.000000; 
		... % qgrLA
		150.000000; 
		150.000000; 
		... % qgrKA
		25.000000; 
		25.000000; 
		... % qsp1
		-1.000000; 
		-1.000000; 
		... % qsp2
		-5.000000; 
		-5.000000; 
		... % qspLA
		-4.000000; 
		-4.000000; 
		... % qspKA
		-10.000000; 
		-10.000000; 
		... % q3
		-20.000000; 
		-20.000000; 
		... % qDLA
		-50.000000; 
		... % q3RL
		-40.000000; 
		... % qxT
		-20.000000; 
		... % qyT
		-10.000000; 
		... % theta
		140.000000; 
		140.000000; 
		... % thetagr
		140.000000; 
		140.000000; 
	];
	qmaxv = [... % maximum q at full positive velocity (dqmax)
		... % q1
		200.000000; 
		200.000000; 
		... % q2
		240.000000; 
		240.000000; 
		... % qLA
		200.000000; 
		200.000000; 
		... % qKA
		140.000000; 
		140.000000; 
		... % qgr1
		200.000000; 
		200.000000; 
		... % qgr2
		240.000000; 
		240.000000; 
		... % qgrLA
		200.000000; 
		200.000000; 
		... % qgrKA
		140.000000; 
		140.000000; 
		... % qsp1
		5.000000; 
		5.000000; 
		... % qsp2
		1.000000; 
		1.000000; 
		... % qspLA
		1.000000; 
		1.000000; 
		... % qspKA
		3.000000; 
		3.000000; 
		... % q3
		10.000000; 
		10.000000; 
		... % qDLA
		50.000000; 
		... % q3RL
		20.000000; 
		... % qxT
		20.000000; 
		... % qyT
		10.000000; 
		... % theta
		220.000000; 
		220.000000; 
		... % thetagr
		220.000000; 
		220.000000; 
	];

	% Check limits
	qbar = T * q * 180/pi;
	dqbar = T * dq * 180/pi;
	violation = (qbar < qmin) | (qbar > qmax) ...
		 | (dqbar < dqmin) | (dqbar > dqmax) ...
		 | dqbar .* (qminv - qmin) < dqmin .* (qbar - qmin) ...
		 | dqbar .* (qmax - qmaxv) > dqmax .* (qmax - qbar);
end
